{"filter":false,"title":"active_admin_has_many_as_table.rb","tooltip":"/config/initializers/active_admin_has_many_as_table.rb","undoManager":{"mark":5,"position":5,"stack":[[{"start":{"row":0,"column":0},"end":{"row":43,"column":3},"action":"insert","lines":["module ActiveAdmin","  class FormBuilder < ::Formtastic::FormBuilder","    def hacked_has_many(association, options = {}, &block)","      options = { :for => association }.merge(options)","      options[:class] ||= \"\"","      options[:class] << \"inputs has_many_fields\"","      # Add Delete Links","      form_block = proc do |has_many_form|","        block.call(has_many_form) + if has_many_form.object.new_record?","                                      template.content_tag :li do","                                        template.link_to I18n.t('active_admin.has_many_delete'), \"#\", :onclick => \"$(this).closest('.has_many_fields').remove(); return false;\", :class => \"button\"","                                      end","                                    else","                                    end","      end","      content = with_new_form_buffer do","        template.content_tag :div, :class => \"has_many #{association}\" do         ","","          # form_buffers.last << template.content_tag(:h3, association.to_s.titlecase)","          # CHANGED INTO","          form_buffers.last << template.content_tag(:h3, I18n.t('custom_translations.'+association.to_s))","","          inputs options, &form_block","","          # Capture the ADD JS","          js = with_new_form_buffer do","            inputs_for_nested_attributes  :for => [association, object.class.reflect_on_association(association).klass.new],","                                          :class => \"inputs has_many_fields\",","                                          :for_options => {","                                            :child_index => \"NEW_RECORD\"","                                          }, &form_block","          end","          js = template.escape_javascript(js)","          _model = 'activerecord.models.' + association.to_s.singularize","          _translated_model = I18n.t(_model)","          js = template.link_to I18n.t('active_admin.has_many_new', :model => _translated_model), \"#\", :onclick => \"$(this).before('#{js}'.replace(/NEW_RECORD/g, new Date().getTime())); return false;\", :class => \"button\"","","          form_buffers.last << js.html_safe","        end","      end","      form_buffers.last << content.html_safe","    end","  end","end"],"id":1}],[{"start":{"row":2,"column":8},"end":{"row":2,"column":15},"action":"remove","lines":["hacked_"],"id":2}],[{"start":{"row":2,"column":16},"end":{"row":2,"column":17},"action":"insert","lines":["_"],"id":3},{"start":{"row":2,"column":17},"end":{"row":2,"column":18},"action":"insert","lines":["a"]},{"start":{"row":2,"column":18},"end":{"row":2,"column":19},"action":"insert","lines":["s"]},{"start":{"row":2,"column":19},"end":{"row":2,"column":20},"action":"insert","lines":["_"]},{"start":{"row":2,"column":20},"end":{"row":2,"column":21},"action":"insert","lines":["t"]},{"start":{"row":2,"column":21},"end":{"row":2,"column":22},"action":"insert","lines":["a"]}],[{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["b"],"id":4},{"start":{"row":2,"column":23},"end":{"row":2,"column":24},"action":"insert","lines":["l"]},{"start":{"row":2,"column":24},"end":{"row":2,"column":25},"action":"insert","lines":["e"]}],[{"start":{"row":21,"column":0},"end":{"row":22,"column":0},"action":"insert","lines":["          form_buffers.last << template.content_tag(:h3, I18n.t('custom_translations.'+association.to_s))",""],"id":5}],[{"start":{"row":21,"column":53},"end":{"row":21,"column":55},"action":"remove","lines":["h3"],"id":6},{"start":{"row":21,"column":53},"end":{"row":21,"column":54},"action":"insert","lines":["p"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":22,"column":0},"end":{"row":22,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1536206446571,"hash":"ff0626933871323686cf51eee9dd49b441fd7b04"}